# Google Drive Setup - ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡πâ‡∏≤‡∏ô‡∏û‡∏±‡∏Å‡∏Ñ‡∏£‡∏π

## ‚úÖ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: Setup ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå

### üìä Spreadsheet ‡∏´‡∏•‡∏±‡∏Å
- **‡∏ä‡∏∑‡πà‡∏≠**: Teacher Housing Management System
- **Spreadsheet ID**: `1X_I7Yj1xm8IOszkD37MvVG8WUGbBrxdK6Os9nyc3UmY`
- **URL**: https://docs.google.com/spreadsheets/d/1X_I7Yj1xm8IOszkD37MvVG8WUGbBrxdK6Os9nyc3UmY/edit

### üìÅ Google Drive Folders

| ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå | Folder ID | URL | ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå |
|---------|-----------|-----|-------------|
| **PaymentSlips** | `1RK8PFdrFFGw_6gsmUxDrUqtCWZYuhUJF` | [‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå](https://drive.google.com/drive/folders/1RK8PFdrFFGw_6gsmUxDrUqtCWZYuhUJF) | ‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô |
| **AboutImages** | `1wVbFJ90GOoxM0FHe8ks8ddpRdw3OCrwQ` | [‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå](https://drive.google.com/drive/folders/1wVbFJ90GOoxM0FHe8ks8ddpRdw3OCrwQ) | ‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö |
| **Exports** | `1JCt9ooyxkGvvKyhG-HuEysqf0ghKbgsg` | [‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå](https://drive.google.com/drive/folders/1JCt9ooyxkGvvKyhG-HuEysqf0ghKbgsg) | ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• |

---

## üîß ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤

### 1. `uploadPaymentSlip(base64Data, roundId, unitId, userId)`
- **‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå**: ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô (Base64) ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Drive
- **‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå**: PaymentSlips
- **‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÑ‡∏ü‡∏•‡πå**: `slip_{roundId}_{unitId}_{timestamp}.jpg/png`
- **Permissions**: Anyone with link can view

### 2. `uploadAboutImage(base64Data, sectionId)`
- **‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå**: ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö (Base64) ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Drive
- **‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå**: AboutImages
- **‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÑ‡∏ü‡∏•‡πå**: `about_{sectionId}_{timestamp}.jpg/png/gif/webp`
- **Permissions**: Anyone with link can view

### 3. `saveExportFile(spreadsheetId, exportName)`
- **‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå**: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ü‡∏•‡πå Export ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå Exports
- **‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå**: Exports
- **‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô**: ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Spreadsheet ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå

### 4. `cleanupOldFiles(folderKey, daysOld)`
- **‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå**: ‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏Å‡πà‡∏≤ (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö cleanup)
- **‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå**: 
  - `folderKey`: 'PAYMENT_SLIPS', 'ABOUT_IMAGES', ‡∏´‡∏£‡∏∑‡∏≠ 'EXPORTS'
  - `daysOld`: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô (default: 365)

---

## üîÑ ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

### ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏á‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
1. Frontend ‡∏™‡πà‡∏á Base64 image ‡∏°‡∏≤‡∏ó‡∏µ‡πà `submitPayment()`
2. ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô Base64 ‡∏´‡∏£‡∏∑‡∏≠ URL
3. ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô Base64 ‚Üí ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `uploadPaymentSlip()` ‚Üí ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏õ Drive
4. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Drive URL ‡∏•‡∏á‡πÉ‡∏ô Sheet `Payments`

### ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Admin ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö
1. Frontend ‡∏™‡πà‡∏á Base64 image ‡∏°‡∏≤‡∏ó‡∏µ‡πà `saveAboutSection()`
2. ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô Base64 ‡∏´‡∏£‡∏∑‡∏≠ URL
3. ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô Base64 ‚Üí ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `uploadAboutImage()` ‚Üí ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏õ Drive
4. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Drive URL ‡∏•‡∏á‡πÉ‡∏ô Sheet `AboutContent`

### ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
1. ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á Spreadsheet ‡πÉ‡∏´‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
2. ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `saveExportFile()` ‚Üí ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå Exports
3. ‡∏Ñ‡∏∑‡∏ô URL ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå Export

---

## ‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Permissions

### Google Apps Script ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå:
1. **Spreadsheet Access**: ‡∏≠‡πà‡∏≤‡∏ô/‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Spreadsheet ‡∏´‡∏•‡∏±‡∏Å
2. **Drive Access**: ‡∏≠‡πà‡∏≤‡∏ô/‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
3. **Folder Access**: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤:
1. ‡πÄ‡∏õ‡∏¥‡∏î Google Apps Script Editor
2. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Project Settings** ‚Üí **OAuth consent screen**
3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Scopes:
   - `https://www.googleapis.com/auth/spreadsheets`
   - `https://www.googleapis.com/auth/drive.file`
4. Deploy ‚Üí Test as me ‚Üí Authorize permissions

---

## üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç

### 1. File Naming
- ‡∏™‡∏•‡∏¥‡∏õ: `slip_{roundId}_{unitId}_{timestamp}.jpg`
- ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û: `about_{sectionId}_{timestamp}.jpg`
- Export: ‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏‡πÉ‡∏ô `exportAllData()`

### 2. File Permissions
- ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πá‡∏ô "Anyone with link can view"
- ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á login

### 3. Storage Management
- ‡πÉ‡∏ä‡πâ `cleanupOldFiles()` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏Å‡πà‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)
- ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ô cleanup ‡∏ó‡∏∏‡∏Å 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏´‡∏£‡∏∑‡∏≠ 1 ‡∏õ‡∏µ

### 4. Error Handling
- ‡∏ñ‡πâ‡∏≤‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ñ‡∏∑‡∏ô error message
- ‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö

---

## ‚úÖ Checklist ‡∏Å‡∏≤‡∏£ Setup

- [x] ‡∏™‡∏£‡πâ‡∏≤‡∏á Spreadsheet ‡∏´‡∏•‡∏±‡∏Å
- [x] ‡∏™‡∏£‡πâ‡∏≤‡∏á Sheets ‡∏ó‡∏±‡πâ‡∏á 14 ‡πÅ‡∏ú‡πà‡∏ô
- [x] ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå PaymentSlips
- [x] ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå AboutImages
- [x] ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå Exports
- [x] ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï config.gs
- [x] ‡∏™‡∏£‡πâ‡∏≤‡∏á drive.gs
- [x] ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï billing.gs
- [x] ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï about.gs
- [x] ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï importexport.gs
- [x] **Header Rows** - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏á)
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ Admin ‡∏Ñ‡∏ô‡πÅ‡∏£‡∏Å - **Required** (‡πÉ‡∏ä‡πâ `createFirstAdmin()`)
- [ ] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Permissions ‡πÉ‡∏ô Google Apps Script - **Required**
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£ Export

---

**‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î**: 2024  
**‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞**: ‚úÖ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
